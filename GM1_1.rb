#!/usr/bin/env ruby

#由于第一个值的预测结果符合精度要求，在此就没列出
#
#原始温度
origin = [-0.3,0.3,1.0,1.3,1.1,-0.2,-1.0,0.4,1.0,1.1,1.4,1.6,1.8,2.0,0.7,-0.8,-1.0,0.6,1.0,1.5,1.7,1.7,1.6]

#根据GM(1,1)的预测值
prediction = [0.43,0.45,0.47,0.5,0.53,0.56,0.59,0.62,0.65,0.69,0.72,0.76,0.8,0.85,0.89,0.94,0.99,1.06,1.1,1.16,1.23,1.29,1.36,]

#需要改进的残差序列
array = [-0.73,-0.15,0.53,0.80,0.57,-0.76,-1.59,-0.22,0.36,0.41,0.68,0.84,1.00,1.15,-0.19,-1.74,-1.99,-0.45,-0.1,0.34,0.47,0.41,0.24]

#对残差序列做正化处理
array.collect!{ |x| x + 3.98 }

#正化处理后的残差序列再次代入GM（1，1），进行残差预测
xy = [3.25,4.0930,4.0848,4.0766,4.0684,4.0602,4.0520,4.0439,4.0357,4.0276,4.0195,4.0114,4.0034,3.9953,3.9873,3.9792,3.9712,3.9632,3.9553,3.9473,3.9394,3.9314,3.9235]

#对正化处理进行还原
xy.collect!{ |x| x - 3.98 }

p xy

#原始预测值与残差预测值相加得到改进后的预测值
result=xy.zip(prediction).map{ |x,y| x + y }


